<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${product.name}">Chi ti·∫øt s·∫£n ph·∫©m</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body class="d-flex flex-column min-vh-100">

<!-- Header -->
<div th:replace="~{layout/_fragments :: main-header}"></div>

<main class="flex-shrink-0">
    <div class="container py-5">
        <div class="row">
            <!-- H√¨nh ·∫£nh s·∫£n ph·∫©m -->
            <div class="col-md-6">
                <img th:src="@{'/picture/' + ${product.image}}" 
                     class="img-fluid rounded shadow" alt="·∫¢nh s·∫£n ph·∫©m">
            </div>

            <!-- Th√¥ng tin chi ti·∫øt -->
            <div class="col-md-6">
                <h2 class="mb-3" th:text="${product.name}">T√™n s·∫£n ph·∫©m</h2>
                <h4 class="text-danger mb-4" 
                    th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + 'ƒë'">Gi√°</h4>

                <!-- üß¢ Ch·ªçn size + Th√™m v√†o gi·ªè -->
                <form th:action="@{/cart/add}" method="post" class="mb-4">
                    <input type="hidden" name="productId" th:value="${product.id}">

                    <div class="mb-3">
                        <label for="size" class="form-label fw-bold">Ch·ªçn size:</label>
                        <select class="form-select w-50" id="size" name="size" required>
                            <option value="" disabled selected>-- Ch·ªçn size --</option>
                            <option value="S">S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                        </select>
                    </div>

                    <div class="d-flex gap-3">
                        <button type="submit" class="btn btn-dark">
                            <i class="fa fa-shopping-cart"></i> Th√™m v√†o gi·ªè
							<!-- ‚úÖ Qu·∫£n tr·ªã s·∫£n ph·∫©m (ch·ªâ hi·ªán n·∫øu ƒëƒÉng nh·∫≠p l√† ADMIN) -->
							<div th:if="${session.role == 'ADMIN'}" class="mt-4 border-top pt-3">
							    <h5 class="fw-bold text-primary mb-3">üîß Qu·∫£n tr·ªã s·∫£n ph·∫©m</h5>

							    <div class="d-flex gap-2">
							        <form th:action="@{'/products/edit/' + ${product.id}}" method="get">
							            <button type="submit" class="btn btn-warning">
							                <i class="fa fa-pen"></i> Ch·ªânh s·ª≠a
							            </button>
							        </form>

							        <form th:action="@{'/products/delete/' + ${product.id}}" method="post"
							              onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y kh√¥ng?');">
							            <button type="submit" class="btn btn-danger">
							                <i class="fa fa-trash"></i> X√≥a s·∫£n ph·∫©m
							            </button>
							        </form>
							    </div>
							</div>

                        </button>
                        <a href="/" class="btn btn-outline-secondary">
                            <i class="fa fa-arrow-left"></i> Quay l·∫°i
                        </a>
						
                    </div>
                </form>
            </div>
        </div>
    </div>
</main>


<!-- ==================== S·∫¢N PH·∫®M LI√äN QUAN ==================== -->
<section class="container my-5">
    <h3 class="text-center fw-bold mb-4">S·∫£n ph·∫©m li√™n quan</h3>
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4">
        <div class="col" th:each="p : ${relatedProducts}">
            <div class="card border-0 shadow-sm h-100">
                <a th:href="@{'/products/detail/' + ${p.id}}">
                    <img th:src="@{'/picture/' + ${p.image}}" class="card-img-top" alt="·∫¢nh s·∫£n ph·∫©m">
                </a>
                <div class="card-body text-center">
                    <h6 class="card-title text-truncate" th:text="${p.name}">T√™n s·∫£n ph·∫©m</h6>
                    <p class="text-danger fw-bold mb-2" 
                       th:text="${#numbers.formatDecimal(p.price, 0, 'COMMA', 0, 'POINT')} + 'ƒë'">Gi√°</p>
                    <a th:href="@{'/products/detail/' + ${p.id}}" class="btn btn-outline-dark btn-sm">
                        <i class="fa fa-eye"></i> Xem chi ti·∫øt
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<div th:replace="~{layout/_fragments :: main-footer}"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
